#include <key.h>
#include "led.h"
#include "lcd.h"
#include "sysclock.h"
#include "motor.h"
#include "MSP430F5529.h"
#include "compositeChars.h"


//char switchFlag=0;
//char str_P_x1[4],str_P_y1[4],str_P_x2[4],str_P_y2[4],str_P_r[4];

void Show(void);
void Converse(void);
void MCU_Init(void);

void PWM_Init(void)//方波启动
{
  //WDTCTL = WDTPW + WDTHOLD;               // Stop WDT
  TA1CTL = TASSEL_2 + MC_3 + TACLR;         // SMCLK, 增减计数, clear TAR
  TA1CCR0 = 128;                            // PWM Period/2
  TA1CCTL1 = OUTMOD_6;                      // CCR1 toggle/set
  TA1CCR1 = 64;                             // CCR1 PWM duty cycle
  P2DIR |= BIT0;                       		// P2.0 and P2.1 output    P1.2
  P2SEL |= BIT0;                       		// P2.0 and P2.1 options select
  __bis_SR_register(LPM0_bits);             // Enter LPM0
  __no_operation();                         // For debugger

}
void main (void)
{
//	char key=3,m2=5,m1=0,n2=5,n1=0;
//	char flag_1=0,flag_2=0,flag_3=0;
	MCU_Init();
	L2_Forward();
	PWM_Init();


}

//void Show(void)
//{
//
//	if(function==1)
//	{
//		DrawcharS("1.line",0,0);
//		DrawcharS(" start",1,1);DrawcharS(str_P_x1,1,8);DrawcharS(",",1,11);DrawcharS(str_P_y1,1,12);
//		DrawcharS(" end  ",2,1);DrawcharS(str_P_x2,2,8);DrawcharS(",",2,11);DrawcharS(str_P_y2,2,12);
//	}
//	else if(function==2)
//	{
//		DrawcharS("2.Straight",0,0);
//		DrawcharS(" start",1,1);DrawcharS(str_P_x1,1,8);DrawcharS(",",1,11);DrawcharS(str_P_y1,1,12);
//		DrawcharS(" end  ",2,1);DrawcharS(str_P_x2,2,8);DrawcharS(",",2,11);DrawcharS(str_P_y2,2,12);
//	}
//	else if(function==3)
//	{
//		DrawcharS("3.Circle",0,0);
//		DrawcharS(" point",1,1);DrawcharS(str_P_x1,1,8);DrawcharS(",",1,11);DrawcharS(str_P_y1,1,12);
//		DrawcharS(" raduis",2,1);DrawcharS(str_P_r,2,8);
//	}
//	else
//	{
//		DrawcharS("1.line",0,0);
//		DrawcharS("2.Straight",1,0);
//		DrawcharS("3.Circle",2,0);
//	}
//
//	if(function!=0)
//	{
//		if(switchFlag%2==0)
//		{
//			DrawcharS("*",1,0);
//			DrawcharS("  ",2,0);
//		}
//		else
//		{
//			DrawcharS("*",2,0);
//			DrawcharS("  ",1,0);
//		}
//	}
//
//}
//
//void Converse(void)
//{
//	itoa(P_x1,str_P_x1);
//	itoa(P_x2,str_P_x2);
//	itoa(P_y1,str_P_y1);
//	itoa(P_y2,str_P_y2);
//	itoa(P_r ,str_P_r);
//}
//

void MCU_Init(void)
{
	WDTCTL=WDTPW+WDTHOLD; //关闭看门狗
	CLK_Init();
	LCDInit();
	LedInit();
	KeyPort_Init();
	MotorPort_Init();

	Clear();
	DrawcharS("Project-5",1,4);
	DrawcharS("5.1--now",2,4);
	Delay_ms(1000);
	Clear();
	_enable_interrupts();							//使能总中断

}
